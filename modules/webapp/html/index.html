<!DOCTYPE html>
<html>
<head>
<link rel="shortcut icon" href="static/favicon.ico" type="image/x-icon">
<link rel="icon" href="static/favicon.ico" type="image/x-icon">
<title>GokGok</title>
</head>
<body>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/css/bootstrap.css">

    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>


<br>
<h1 align='center'>Scan Results!</h1>
<br>

<div class="container">
    {{ range .List }}
    {{ range .Hostnames }}
    <h2>Host {{.Name}}</h2>
    {{ end }}
    <table id="example"class="table table-striped table-bordered" style="width:100%">
            <thead class="thead-dark">
                <tr>
                    <th scope="col">Port</th>
                    <th scope="col">Service</th>
                    <th scope="col">Product</th>
                    <th scope="col">Version</th>
                    <th scope="col">CVE</th>
                </tr>
                {{ range .Ports }}
                <tr>
                
                    <td>{{.PortId}}</td>
                    <td>{{.Service.Name}}</td>

                    {{ if .Service.Product}}
                    <td>{{.Service.Product}}</td>
                    {{else}}
                    <td> - </td>
                    {{ end }}
                    
                    {{ if .Service.Version }}
                    <td>{{.Service.Version}} </td>
                    {{else}}
                    <td> - </td>
                    {{ end }}

                    {{ if .Scripts }}
                        {{ range .Scripts }}
                        <td>{{.Output}}</td>
                        {{ end }}
                    {{else}}
                    <td> - </td>
                    {{ end }}
                </tr>
                {{ end }}
            </thead>
        </table>
    {{ end }}
    
        
    </div>


</body>
</html>